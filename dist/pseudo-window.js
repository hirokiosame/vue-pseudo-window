!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).PseudoWindow=factory()}(this,(function(){"use strict";function isDef(v){return null!=v}function stringifyClass(value){return Array.isArray(value)?function(value){let stringified,res="";for(let i=0,l=value.length;i<l;i++)isDef(stringified=stringifyClass(value[i]))&&""!==stringified&&(res&&(res+=" "),res+=stringified);return res}(value):null!==(obj=value)&&"object"==typeof obj?function(value){let res="";for(const key in value)value[key]&&(res&&(res+=" "),res+=key);return res}(value):"string"==typeof value?value:"";var obj}const whitespaceRE=/\s+/;var BODY="undefined"!=typeof window&&window.document.body,bindClass=function(_ref){var staticClass,dynamicClass,a,b,data=_ref.data,parent=_ref.parent,classStr=(staticClass=data.staticClass,dynamicClass=data.class,isDef(staticClass)||isDef(dynamicClass)?(a=staticClass,b=stringifyClass(dynamicClass),a?b?`${a} ${b}`:a:b||""):"");if(classStr){!function(el,cls){if(cls&&(cls=cls.trim()))if(el.classList)cls.indexOf(" ")>-1?cls.split(whitespaceRE).forEach(c=>el.classList.add(c)):el.classList.add(cls);else{const cur=` ${el.getAttribute("class")||""} `;cur.indexOf(` ${cls} `)<0&&el.setAttribute("class",(cur+cls).trim())}}(BODY,classStr);var off=function(){!function(el,cls){if(cls&&(cls=cls.trim()))if(el.classList)cls.indexOf(" ")>-1?cls.split(whitespaceRE).forEach(c=>el.classList.remove(c)):el.classList.remove(cls),el.classList.length||el.removeAttribute("class");else{let cur=` ${el.getAttribute("class")||""} `;const tar=` ${cls} `;for(;cur.indexOf(tar)>=0;)cur=cur.replace(tar," ");cur=cur.trim(),cur?el.setAttribute("class",cur):el.removeAttribute("class")}}(BODY,classStr)};parent.$once("hook:beforeUpdate",off),parent.$once("hook:destroyed",off)}},hasOwnProperty=Object.prototype.hasOwnProperty,normalizeEvent=function(M_target,M_name,M_handler){var passive="&"===M_name[0],once="~"===(M_name=passive?M_name.slice(1):M_name)[0],capture="!"===(M_name=once?M_name.slice(1):M_name)[0];return{M_target:M_target,M_name:M_name=capture?M_name.slice(1):M_name,M_handler:M_handler,M_opts:{once:once,capture:capture,passive:passive}}},bindEventListeners=function(ctx){var props,handlers=function(element,$listeners){var obj,prop,handlers=[];for(var eventName in $listeners)if(obj=$listeners,prop=eventName,hasOwnProperty.call(obj,prop)){var eventHandler=$listeners[eventName],e=normalizeEvent(element,eventName,eventHandler);e.M_target.addEventListener(e.M_name,e.M_handler,e.M_opts),handlers.push(e)}return handlers}((props=ctx.props).body?window.document.body:props.document?window.document:window,ctx.listeners),off=function(){!function(handlers){for(var e;e=handlers.shift();)e.M_target.removeEventListener(e.M_name,e.M_handler,e.M_opts)}(handlers)};ctx.parent.$once("hook:beforeUpdate",off),ctx.parent.$once("hook:destroyed",off)},init=function(ctx){bindEventListeners(ctx),ctx.props.body&&bindClass(ctx)};return{name:"pseudo-window",functional:!0,props:{document:Boolean,body:Boolean},render:function(h,ctx){return ctx.parent._isMounted?init(ctx):ctx.parent.$once("hook:mounted",(function(){init(ctx)})),ctx.slots().default}}}));
